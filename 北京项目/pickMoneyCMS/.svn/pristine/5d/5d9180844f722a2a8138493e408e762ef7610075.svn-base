<?php
/**
 * 游戏相关-配置model
 * Author: Jason
 * Date: 18/10/25
 * Time: 下午3:52
 */

namespace app\admin\model\game;

use app\admin\model\BaseModel;

use think\Db;

class GameModel extends BaseModel
{
    protected $game_list_table = 'b_game_list';             //游戏列表
    protected $game_ad_prize_table = 'b_game_ad_prize_list';//游戏广告+红包配置表
    protected function initialize()
    {
        parent::initialize(); // TODO: Change the autogenerated stub
    }


    /**
     * 获取答题游戏相关配置：答题时间、每轮题目数
     * @param $game_id
     * @return array|false|null|\PDOStatement|string|\think\Model
     */
    public function getGameConfig($game_id)
    {
        $where['id'] = $game_id;
        return Db::table($this->game_list_table)->where($where)->field('delay_sec,group_count')->find();
    }

    public function getGameConfigPro($game_id,$field = '*')
    {
        $where['id'] = $game_id;
        return Db::table($this->game_list_table)->where($where)->field($field)->find();
    }

    /**
     * 更新游戏配置
     * @param $data [需要更新的数据]
     * @param $game_id [游戏ID]
     * @return int|string
     */
    public function upConfig($data,$game_id)
    {
        $where['id'] = $game_id;
        return Db::table($this->game_list_table)->where($where)->data($data)->update();
    }

    /**
     * 根据游戏ID获取广告/广告+红包配置
     * @param $game_id [游戏ID]
     * @return array|false|\PDOStatement|string|\think\Collection
     */
    public function getGameAdPrizeList($game_id)
    {
        $where['g_id'] = $game_id;
        $where['p_status'] = 1;
        return Db::table($this->game_ad_prize_table)->where($where)->select();
    }

    /**
     * 更新游戏广告、广告+红包配置
     * @param $id [广告配置ID]
     * @param $data [更新的数据]
     * @return int|string
     */
    public function upGameAdPrizeConfig($id,$data)
    {
        $where['id'] = $id;
        return Db::table($this->game_ad_prize_table)->where($where)->data($data)->update();
    }
}